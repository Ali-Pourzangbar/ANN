function [Y,Xf,Af] = ANN_FcnBOD(X,~,~)
%ANN_FCNBOD neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 08-Oct-2021 10:16:00.
% 
% [Y] = ANN_FcnBOD(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 11xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 1xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [17881.83949;7.09995908872496;4.22491961814;0.288137119;3.7139;5.25424177534222e-07;16386.51949;6.79191501818774;0.0732887082312037;1.14638743887274e-06;0.000697601246687192];
x1_step1.gain = [8.54269483257183e-06;2.2219448622593;0.0604407087797417;0.602071810802115;0.0898129645014258;0.258057530194022;8.54269483257183e-06;2.87131598382951;0.100591854299185;0.130810809264816;0.937616694232311];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.8479798748225122473;-5.307331129069353004;10.765610630215569188;2.2221134242185129892;0.82902779300067441781;6.3722606008721376369;0.2128652567816508856;-5.1864840398163236657;5.0144919570237709294;7.5468990543563077011;-8.5170686591835274015;0.41985352210600757061];
IW1_1 = [-0.81301909650937087548 -1.3145496263516185387 1.5869609741842691797 -2.6137849313891434733 -4.075500052049326527 -0.33845874683332721755 -3.5663227362113776309 9.2543263423403647749 -3.9343315965454621619 6.2915797953577792256 2.5415948478709600167;3.3860120171521725929 1.1756189894025854681 7.2534960675403414854 -3.953252679795400848 1.2015621279794537202 -2.9146252470393885226 5.6089792423505553387 -5.1677457813879321691 -0.31331578572519752646 -2.9788657664288766824 2.2787075337566142785;3.2267003102822071625 3.6492196514174213284 2.3571512733293080721 -4.9776637030509442994 -1.091494045421266712 1.4911820999320117842 -0.014700906842030361799 6.3822936729468899841 8.3885921826720206695 -1.4910006026176867433 3.0660095758573180369;-0.32877618970090760619 0.99819705988157314547 -0.79464234065855210432 1.8869252243770366917 1.3863801036736482786 -1.4890890771230334 -0.14262484604519554132 -5.5384818999878131507 2.412636264469194991 -2.4795329079904679936 -1.1231809786154058894;-0.21364293893300040361 -0.20295131409433711522 -0.60794783733900381595 1.2492271107426833332 -0.72562765253202721194 -1.3753008474799601757 0.12438156855673791756 6.0289685501926548739 -2.3679121547333226161 0.72736691049422963484 1.1894001634583826199;-1.4060773350812045823 3.5404625536437381861 1.9903357452947918471 -1.2683685178349335398 -0.43534819373995076175 -1.2581914704379990599 -0.14899856155069240993 16.399410040116922715 -4.1889486356871605821 5.5124290307225560781 5.7345858587370468484;-1.075026018717482712 -0.1434934878479651732 -1.1184327959530746543 3.2266329926015631102 -0.25775120942706591931 -2.2408163485965593154 -0.62115347687965571932 3.4847353345463587537 -1.7994231777920992599 1.1474488473234969454 -1.5811628071978269805;-0.23334152265292848472 -0.16448151319354203936 0.78467066980082933458 -1.7585272788966785917 -0.951162843978685002 -0.90691131276463443633 -0.23661254498407172098 1.901841195290637776 -4.8776583955250609748 0.17898688257141529001 0.87581646539611235358;0.40367777146509975505 -0.80327804467936436694 1.4585225522172873269 -0.85409351426546464836 3.420452441624154627 0.8014946990707361163 -0.33794525475824072069 0.84814208303885885165 5.4756295350328185734 -0.48559105489556375623 -0.87739653213135326837;2.0727934928214439836 -0.075032132172032944828 -0.099928017271755820161 0.68740335142564468196 -1.3004435373237952511 1.298769805838430047 -2.5355722474948296785 -3.9549812419689267529 10.457808573726991241 1.2936485757717164358 -2.2909190537301378221;0.99193540747056885287 -1.8108618097005972913 0.89899538750672292053 -1.1732756488320654764 2.1905686310762355617 2.2197912330610445331 3.1024239628599925567 -9.9293502011871588309 -2.8313361230787768008 -5.1818112459364620292 0.52432024347126837682;-1.1298531795052477733 -1.5617990069555152122 0.80382629370036784433 -0.89436683106400804988 -0.33318020470132575506 0.19458564142540357711 0.10641952225458327363 -3.8368616036931815216 0.60991604707282964792 0.29231167433376908926 1.1836009243364122856];

% Layer 2
b2 = [4.2002825146264557432;9.5850140285935978568;0.95569524925407078886;6.9393811535453568951;-1.9186417557177328774;-3.0832945729794922762;15.407157069968873131;5.8437263893268101;12.004550463262255278];
LW2_1 = [-6.2648394948115617709 4.5289695488145698121 -2.0231671735481655539 2.6599924081188479619 -1.0037997938906120243 1.6511217526194184035 2.4971437390773245646 7.2324822049458328266 -2.1885910850726002508 -3.0392763762497834179 -2.7363986454426201256 3.344337038851936228;0.32394095725311305989 4.4391637310151796925 -0.023071929882189624872 -7.2982404277280643612 3.0561964372102181642 0.38154951969509953713 -0.53921711592493037912 -5.8230791595126696336 -0.087347624842067678186 0.77381340404182086257 0.013919021328098409723 -1.5789000017584866598;0.74455511959925524401 -1.8228869955452999818 0.62519508671337287176 -1.02518140383527534 -2.4747972131930624506 -0.37547471126129511321 0.39172951863882515822 3.1088396235649211619 0.82177825818511074374 -0.75592007069502753502 -0.64123669701180507907 -0.26697477568215821631;0.90767199969332867937 4.7757794303723501983 -0.97137171275395040038 5.2647133653398965336 2.8776256474780703698 0.78602500127415386721 -0.94988442196370070914 4.3976147044237734463 0.55706185112651018798 -0.054760830585285788508 0.12210725886764794978 -0.9409531963405891597;-0.64470746870426465236 1.6514378084779659517 -0.52764743183487128331 1.4770425687804715764 2.7875913858135676904 0.30928201217737827378 -0.45203032735965947841 -2.2937957952504266501 -0.77615822269605960759 0.73486299010973543666 0.75140267414004924262 1.7493244681624025016;0.12510627589574221941 1.9110839188924069187 4.4945265387082233843 -1.3883953183962902678 -1.7860868843390818039 0.27744858496728014297 0.3709019519149154287 5.0436190653341625989 1.3076313219001056698 -2.1085769790856812023 -0.14548582230797713066 3.5381777757676706742;-1.4336695827758980659 4.8756995778203160441 0.087964338267120384396 -5.169566614151556827 -0.84827452626941046709 -0.35853102565241001809 1.7035046505019733054 -1.4034425300065951348 -1.0222975280986450475 -0.37833398255572753266 0.68517538903421215668 -1.0044234973129697597;-4.394261075725090393 4.0242442208030722028 -2.1581285810531691816 -5.391619813219985069 0.7096942071249613404 1.8720328872616938121 -1.7652738923060316001 -0.013389340441253685943 -2.1839497090739463658 3.0752998509304565466 -1.0530821830292544927 2.4399725846216533398;0.46518247245548505209 -4.6185625675742718599 -5.6777698457516665442 -7.0533167456200391854 0.22008729131462256845 -1.920155530932231791 1.4101927104549216718 -1.6476304733719475681 -1.1192453658300489661 0.70225663879698074776 4.4566730838465469233 1.6787939724333709179];

% Layer 3
b3 = [7.5343986115825902772;-3.3988693387784927324;4.4610986469993649806;-1.2188847280007155671;2.8748410089041369631];
LW3_2 = [0.082945213352116756167 -0.57476630579174303737 -3.9681896905722280344 -4.1031502118649099131 -0.078367577118530137859 -1.4457994734342367593 -0.68389083411431594861 0.5255216184981779115 -0.48240140114452362274;0.024307110683880632507 0.92226650551877897843 2.7253478625697300508 -3.7487619777651888242 -0.36307034361269807654 0.31122319177085072672 -3.2313465245750072619 -0.023143638310581429729 -1.2554139317843806545;0.23921311704564549028 -0.37899827533225871612 3.9277987933219637995 -1.879536912494624401 4.8980613388979321599 -1.5423774125424176695 0.75622916174134779954 0.07965996601213040651 -3.6303370445535647626;-1.1019562029956477822 -3.1545082538657305271 3.4527068057723560024 -0.35469400118617772089 2.4864622989027624911 1.0018532301200473444 -3.1537644309855670244 1.7434329024063712765 1.2586560034919052065;0.22501158899576595429 -0.36848253467660729843 3.4291971114477277638 -1.7074499198624439877 4.2959688350739186902 -1.5307814930123684327 2.0908006805959162833 0.052580303679715251208 -3.6378107779935273669];

% Layer 4
b4 = 1.7039819333711476723;
LW4_3 = [0.08601646729611435449 1.7993887566005104528 -1.9729897681303718571 0.83129954506224645883 2.001282982630989693];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 0.0459870559360496;
y1_step1.xoffset = 1.98751088201668;

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);
    
    % Layer 3
    a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);
    
    % Layer 4
    a4 = repmat(b4,1,Q) + LW4_3*a3;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a4,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(4,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
